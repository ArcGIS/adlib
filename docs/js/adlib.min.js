!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.adlib=e()}(this,function(){"use strict";function n(n,e,t){return void 0===t&&(t=void 0),e.split(".").reduce(function(n,e){return n?n[e]:t},n)}function e(n,e){return Object.keys(n).reduce(function(t,r){return t[r]=e(n[r],r,n),t},{})}function t(n){return n instanceof Date}function r(n){return"function"==typeof n}function o(n){return"object"==typeof n}function u(n){return n instanceof RegExp}function i(n,f,a,c){function l(n,e){return i(n,f,a?a+"."+e:e)}if(a=a||"",Array.isArray(n))return n.map(l);if(!n||!o(n)||t(n)||u(n)||r(n)){return f(n,a)}return Object.assign({},n,e(n,l))}function f(n){return"object"==typeof n}function a(n,t){function r(n,e){return a(n,t?t+"."+e:e)}if(t=t||"",Array.isArray(n)){return c(n.map(r).filter(function(n){return null!==n&&void 0!==n}))}return n&&f(n)?l(e(n,r)):p(n)}function c(n){var e=n,t=n.reduce(function(n,e){if(y(e)&&v(e)){var t=d(e);t>n&&(n=t)}return n},-1);return t>-1&&(e=0===t?[]:"{{delete:"+(t-1)+"}}"),e}function l(n){var e={obj:{},maxLevel:-1},t=Object.keys(n).reduce(function(e,t){var r=n[t];if(y(r)&&v(r)){var o=d(r);o>e.maxLevel&&(e.maxLevel=o)}else e.obj[t]=r;return e},e);return t.maxLevel>0?1===t.maxLevel?void 0:"{{delete:"+(t.maxLevel-1)+"}}":t.obj}function p(n){var e=n;return"string"==typeof n&&v(n)&&(e=s(n)),e}function s(n){var e=d(n);return 0===e?void 0:"{{delete:"+e+"}}"}function d(n){return parseInt(n.replace(/{|}/g,"").split(":")[1])}function v(n){return!(!n||"string"!=typeof n)&&n.indexOf("{{delete")>-1}function y(n){return"string"==typeof n}function m(n,e,t,r){void 0===r&&(r=0);var o=e;return e||(o="{{delete:"+r+"}}"),o}function g(n){return"string"==typeof n}function x(e,t,r){var o,u=e.split(":");if(u.length>1){var i=u[0],f=u[1],a=null;if(u[2]&&(a=u[2]),!r||!r[f]||"function"!=typeof r[f])throw new Error("Attempted to apply non-existant transform "+f+" on "+i+" with params "+a);o=n(t,i),o=r[f](i,o,t,a)}else o=n(t,e);return o}function b(n,e,t){if(void 0===t&&(t=null),t=t||{},t.optional)throw new Error("Please do not pass in an `optional` transform, adlib provides that interally.");return t.optional=m,a(i(n,function(n,r){if(!g(n))return n;var o,u=/{{([\w\.\:]+)}}/g,i=n.match(u);if(i&&i.length){return i.map(function(n){return{key:n,value:x(n.replace(/{|}/g,""),e,t)||n}}).forEach(function(e){if(n==e.key)o=e.value;else{var t=new RegExp(e.key,"g");n=n.replace(t,e.value)}}),o||n}return n}))}return b});
//# sourceMappingURL=adlib.min.js.map
