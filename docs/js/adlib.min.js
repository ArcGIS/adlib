!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.adlib=e()}(this,function(){"use strict";function n(n,e,t){return void 0===t&&(t=void 0),e.split(".").reduce(function(n,e){return n?n[e]:t},n)}function e(n,e){return Object.keys(n).reduce(function(t,r){return t[r]=e(n[r],r,n),t},{})}function t(n){return n instanceof Date}function r(n){return"function"==typeof n}function i(n){return"object"==typeof n}function u(n){return n instanceof RegExp}function o(n,f,a,c){function l(n,e){return o(n,f,a?a+"."+e:e)}if(a=a||"",Array.isArray(n))return n.map(l);if(!n||!i(n)||t(n)||u(n)||r(n)){return f(n,a)}return Object.assign({},n,e(n,l))}function f(n){return"object"==typeof n}function a(n,t){function r(n,e){return a(n,t?t+"."+e:e)}if(t=t||"",Array.isArray(n)){return c(n.map(r).filter(function(n){return null!==n&&void 0!==n}))}return n&&f(n)?l(e(n,r)):p(n)}function c(n){var e=n,t=n.reduce(function(n,e){if(y(e)&&v(e)){var t=d(e);t>n&&(n=t)}return n},-1);return t>-1&&(e=0===t?[]:"{{delete:"+(t-1)+"}}"),e}function l(n){var e={obj:{},maxLevel:-1},t=Object.keys(n).reduce(function(e,t){var r=n[t];if(y(r)&&v(r)){var i=d(r);i>e.maxLevel&&(e.maxLevel=i)}else e.obj[t]=r;return e},e);return t.maxLevel>0?1===t.maxLevel?void 0:"{{delete:"+(t.maxLevel-1)+"}}":t.obj}function p(n){var e=n;return"string"==typeof n&&v(n)&&(e=s(n)),e}function s(n){var e=d(n);return 0===e?void 0:"{{delete:"+e+"}}"}function d(n){return parseInt(n.replace(/{|}/g,"").split(":")[1])}function v(n){return!(!n||"string"!=typeof n)&&n.indexOf("{{delete")>-1}function y(n){return"string"==typeof n}function m(n,e,t,r){void 0===r&&(r=0);var i=e;return e||(i="{{delete:"+r+"}}"),i}function g(n){return"string"==typeof n}function x(e,t,r){var i,u=e.split(":");if(u.length>1){var o=u[0],f=u[1],a=null;if(u[2]&&(a=u[2]),!r||!r[f]||"function"!=typeof r[f])throw new Error("Attempted to apply non-existant transform "+f+" on "+o+" with params "+a);i=n(t,o),i=r[f](o,i,t,a)}else i=n(t,e);return i}function b(e,t,r){if(void 0===r&&(r=null),r=r||{},r.optional)throw new Error("Please do not pass in an `optional` transform, adlib provides that interally.");return r.optional=m,a(o(e,function(e,i){if(!g(e))return e;var u,o=/{{([\w\.\:(||)?]+)}}/g,f=e.match(o);if(f&&f.length){return f.map(function(e){var i=e.replace(/{|}/g,"");if(-1!==i.indexOf("||")){i=i.split("||").find(function(e){var r=n(t,e.split(":")[0],null);return null!==r&&void 0!==r})}return{key:e,value:x(i,t,r)||e}}).forEach(function(n){if(e==n.key)u=n.value;else{var t=new RegExp(n.key.replace(/\|\|/gi,"\\|\\|"));e=e.replace(t,n.value)}}),u||e}return e}))}return b});
//# sourceMappingURL=adlib.min.js.map
