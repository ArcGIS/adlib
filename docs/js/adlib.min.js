!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):n.adlib=e()}(this,function(){"use strict";function n(n,e,t){return void 0===t&&(t=void 0),e.split(".").reduce(function(n,e){return n?n[e]:t},n)}function e(n,e){return Object.keys(n).reduce(function(t,r){return t[r]=e(n[r],r,n),t},{})}function t(n){return n instanceof Date}function r(n){return"function"==typeof n}function u(n){return"object"==typeof n}function o(n){return n instanceof RegExp}function i(n,f,a,l){function c(n,e){return i(n,f,a?a+"."+e:e)}if(a=a||"",Array.isArray(n))return n.map(c);if(!n||!u(n)||t(n)||o(n)||r(n)){return f(n,a)}return Object.assign({},n,e(n,c))}function f(n){return"object"==typeof n}function a(n,t){function r(n,e){return a(n,t?t+"."+e:e)}if(t=t||"",Array.isArray(n)){return l(n.map(r).filter(function(n){return null!==n&&void 0!==n}))}return n&&f(n)?c(e(n,r)):v(n)}function l(n){var e=n,t=n.reduce(function(n,e){if(y(e)&&d(e)){var t=p(e);t>n&&(n=t)}return n},-1);return t>-1&&(e=0===t?[]:"{{delete:"+(t-1)+"}}"),e}function c(n){var e={obj:{},maxLevel:-1},t=Object.keys(n).reduce(function(e,t){var r=n[t];if(y(r)&&d(r)){var u=p(r);u>e.maxLevel&&(e.maxLevel=u)}else e.obj[t]=r;return e},e);return t.maxLevel>0?1===t.maxLevel?void 0:"{{delete:"+(t.maxLevel-1)+"}}":t.obj}function v(n){var e=n;return"string"==typeof n&&d(n)&&(e=s(n)),e}function s(n){var e=p(n);return 0===e?void 0:"{{delete:"+e+"}}"}function p(n){return parseInt(n.replace(/{|}/g,"").split(":")[1])}function d(n){return!(!n||"string"!=typeof n)&&n.indexOf("{{delete")>-1}function y(n){return"string"==typeof n}function m(n,e,t,r){void 0===r&&(r=0);var u=e;return e||(u="{{delete:"+r+"}}"),u}function g(n){return"string"==typeof n}function x(e,t,r){var u,o=e.split(":");if(o.length>1){var i=o[0],f=o[1],a=null;if(o[2]&&(a=o[2]),!r||!r[f]||"function"!=typeof r[f])throw new Error("Attempted to apply non-existant transform "+f+" on "+i+" with params "+e);u=n(t,i),u=r[f](i,u,t,a)}else u=n(t,e);return u}function b(e,t){var r=e.split(":")[0],u=n(t,r,null);return null!==u&&void 0!==u}function h(n,e,t){if(void 0===t&&(t=null),t=t||{},t.optional)throw new Error("Please do not pass in an `optional` transform, adlib provides that interally.");return t.optional=m,a(i(n,function(n,r){if(!g(n))return n;var u,o=/{{[\w\.\:||&\/?=]*?}}/g,i=n.match(o);if(i&&i.length){var f=!1;return i.map(function(n){var r=n.replace(/{|}/g,"");if(r.indexOf("||")>-1){var u=r.split("||"),o=u.length;r=u.find(function(n,t){return b(n,e)?n:t+1===o&&(f=!0,isNaN(n)||(n=parseInt(n)),n)})}var i={key:n,value:r};return f||(i.value=x(r,e,t)||n),i}).forEach(function(e){n===e.key?("string"==typeof e.value&&(isNaN(e.value)||(e.value.indexOf(".")>-1?e.value=parseFloat(e.value):e.value=parseInt(e.value))),u=e.value):(console.log("KEY "+e.key),console.log("TEMPLATE "+n),n=n.replace(e.key,e.value))}),u||n}return n}))}return h});
//# sourceMappingURL=adlib.min.js.map
